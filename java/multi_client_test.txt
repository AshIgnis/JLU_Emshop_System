# 多客户端并发测试指令集
# 模拟多个用户同时使用系统的真实场景

# ====================================================================
# 客户端1：普通用户购物流程
# ====================================================================

# 客户端1连接后执行的命令序列：
# 1. 用户注册和登录
REGISTER user001_new password123 13801111111
LOGIN user001_new password123

# 2. 浏览商品
GET_PRODUCTS
CHECK_STOCK 1
CHECK_STOCK 2

# 3. 购物车操作
ADD_TO_CART 1 1 2
ADD_TO_CART 1 3 1
GET_CART 1

# 4. 继续购物
ADD_TO_CART 1 5 1
UPDATE_CART 1 1 3
GET_CART 1

# ====================================================================
# 客户端2：另一个用户的并发操作
# ====================================================================

# 客户端2连接后执行的命令序列：
# 1. 用户注册和登录
REGISTER user002_new password456 13802222222
LOGIN user002_new password456

# 2. 同时浏览相同商品（测试并发读取）
GET_PRODUCTS
CHECK_STOCK 1
CHECK_STOCK 3

# 3. 竞争同一商品库存
ADD_TO_CART 2 1 5
ADD_TO_CART 2 2 3
GET_CART 2

# 4. 库存操作冲突测试
UPDATE_STOCK 1 10 subtract
CHECK_STOCK 1

# ====================================================================
# 客户端3：管理员操作
# ====================================================================

# 客户端3连接后执行的命令序列：
# 1. 管理员登录
LOGIN admin 123456

# 2. 库存管理操作
GET_LOW_STOCK_PRODUCTS 20
UPDATE_STOCK 2 50 add
UPDATE_STOCK 3 30 add

# 3. 监控系统状态
CHECK_STOCK 1
CHECK_STOCK 2
CHECK_STOCK 3

# ====================================================================
# 客户端4：高频访问用户
# ====================================================================

# 客户端4连接后执行的命令序列：
# 1. 快速注册登录
REGISTER user003_new password789 13803333333
LOGIN user003_new password789

# 2. 频繁查询操作
GET_PRODUCTS
GET_PRODUCTS all 1 5
GET_PRODUCTS all 2 5
CHECK_STOCK 1
CHECK_STOCK 2
CHECK_STOCK 3
CHECK_STOCK 4
CHECK_STOCK 5

# 3. 购物车快速操作
ADD_TO_CART 3 7 2
ADD_TO_CART 3 8 1
GET_CART 3
REMOVE_FROM_CART 3 7
GET_CART 3

# ====================================================================
# 客户端5：压力测试用户
# ====================================================================

# 客户端5连接后执行的命令序列：
# 1. 注册登录
REGISTER user004_new password000 13804444444
LOGIN user004_new password000

# 2. 大量商品操作
ADD_TO_CART 4 1 1
ADD_TO_CART 4 2 1
ADD_TO_CART 4 3 1
ADD_TO_CART 4 4 1
ADD_TO_CART 4 5 1
ADD_TO_CART 4 6 1
ADD_TO_CART 4 7 1
ADD_TO_CART 4 8 1

# 3. 查看购物车
GET_CART 4

# 4. 批量清理
CLEAR_CART 4
GET_CART 4

# ====================================================================
# 并发测试场景说明
# ====================================================================

# 场景1：库存竞争
# - 客户端1和客户端2同时尝试购买商品1
# - 测试库存扣减的原子性

# 场景2：购物车隔离
# - 多个用户同时操作各自的购物车
# - 验证用户数据隔离性

# 场景3：读写并发
# - 用户查询商品的同时管理员更新库存
# - 测试读写锁机制

# 场景4：高并发查询
# - 多个客户端同时查询商品列表
# - 测试系统吞吐量

# 场景5：连接管理
# - 测试服务器同时处理多个TCP连接
# - 验证连接池和资源管理

# ====================================================================
# 测试执行方法
# ====================================================================

# 方法1：手动多窗口测试
# 1. 开启多个命令行窗口
# 2. 每个窗口连接到服务器
# 3. 按照上述命令序列并发执行

# 方法2：脚本自动化测试
# 1. 创建多个客户端连接脚本
# 2. 同时启动多个脚本
# 3. 观察服务器日志和响应

# 方法3：压力测试工具
# 1. 使用网络压力测试工具
# 2. 模拟大量并发连接
# 3. 监控系统性能指标
